<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Babel - Diario de Desarrollo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        nav {
            background: white;
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
        }
        nav a {
            color: #3498db;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
            font-weight: 500;
        }
        nav a:hover {
            background: #3498db;
            color: white;
        }
        main {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }
        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #3498db;
        }
        .stat-label {
            color: #7f8c8d;
            margin-top: 0.5rem;
        }
        .session {
            background: white;
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .session:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }
        .session-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #ecf0f1;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .session-title {
            font-size: 1.5rem;
            color: #2c3e50;
            flex: 1;
        }
        .session-meta {
            color: #7f8c8d;
            font-size: 0.9rem;
            text-align: right;
        }
        .session-tags {
            display: flex;
            gap: 0.5rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }
        .tag {
            background: #3498db;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
        }
        .tag.setup { background: #9b59b6; }
        .tag.bugfix { background: #e74c3c; }
        .tag.feature { background: #2ecc71; }
        .tag.documentation { background: #f39c12; }
        .tag.refactor { background: #1abc9c; }
        .session-summary {
            margin: 1rem 0;
            color: #555;
            line-height: 1.8;
        }
        .session-link {
            display: inline-block;
            margin-top: 1rem;
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        .session-link:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        footer {
            text-align: center;
            padding: 2rem;
            color: #7f8c8d;
            margin-top: 4rem;
        }
    </style>
</head>
<body>
    <header>
        <h1>üèóÔ∏è Babel - Diario de Desarrollo</h1>
        <p>Sistema de Gesti√≥n Documental con IA y OCR</p>
    </header>

    <nav id="session-menu">
        <ul>
            <!-- Sesiones se a√±adir√°n aqu√≠ din√°micamente -->
        </ul>
    </nav>

    <main>
        <div class="stats">
            <div class="stat-card">
                <div class="stat-value" id="total-sessions">13</div>
                <div class="stat-label">Sesiones Totales</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="total-hours">21.5h</div>
                <div class="stat-label">Horas de Desarrollo</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="last-session">2026-01-30</div>
                <div class="stat-label">√öltima Sesi√≥n</div>
            </div>
        </div>

        <div id="sessions-container">
            <!-- Sesiones se a√±adir√°n aqu√≠ din√°micamente -->
        </div>
    </main>

    <footer>
        <p>Generado autom√°ticamente por Claude Code | √öltima actualizaci√≥n: <span id="last-update"></span></p>
    </footer>

    <script>
        const sessions = [
            {
                id: '20260130_170204',
                date: '2026-01-30',
                time: '17:02',
                duration: '1.0h',
                title: 'Fase 9: Servicio de Chat RAG',
                summary: 'Implementaci√≥n completa del servicio de Chat RAG: (1) VectorSearchResult y SearchAsync en IVectorStoreService con filtro por proyecto. (2) Chat Completion configurado para OpenAI y Ollama en Semantic Kernel. (3) IChatService con ChatAsync y ChatStreamAsync. (4) SemanticKernelChatService con flujo RAG completo: embedding consulta, b√∫squeda vectorial, construcci√≥n contexto, llamada LLM. (5) ChatQuery/Handler/Validator de MediatR. (6) Errores de dominio para Chat. 111 tests pasan.',
                tags: ['feature'],
                docPath: 'sessions/20260130_170204_servicio_chat_rag.md'
            },
            {
                id: '20260130_120000',
                date: '2026-01-30',
                time: '12:00',
                duration: '2.5h',
                title: 'Fix: Pipeline Completo de Vectorizaci√≥n con OpenAI',
                summary: 'Correcci√≥n del pipeline completo de vectorizaci√≥n: (1) Hangfire no estaba configurado en WebUI, se centraliz√≥ AddHangfireServices(). (2) SemanticKernelEmbeddingService usaba interfaz incorrecta, se reescribi√≥ para usar ITextEmbeddingGenerationService. (3) DbUpdateConcurrencyException al marcar documentos vectorizados, se cre√≥ MarkAsVectorizedAsync() con ExecuteUpdateAsync. (4) Configuraci√≥n de OpenAI en WebUI. Se gener√≥ INFORME_VECTORIZACION.md documentando todo el sistema.',
                tags: ['bugfix', 'documentation'],
                docPath: 'INFORME_VECTORIZACION.md'
            },
            {
                id: '20260126_162831',
                date: '2026-01-26',
                time: '16:28',
                duration: '1.0h',
                title: 'Bugfix: Conexi√≥n Qdrant gRPC y Bucle Infinito ChunkingService',
                summary: 'Correcci√≥n de dos bugs cr√≠ticos: (1) QdrantClient usaba puerto REST en lugar de gRPC, causando errores de conexi√≥n. Se actualiz√≥ la configuraci√≥n para usar Host/GrpcPort. (2) Bucle infinito en ChunkingService cuando el overlap hac√≠a que nextPosition <= currentPosition. Se mejor√≥ el logging de InMemoryDocumentProcessingQueue para facilitar diagn√≥stico. 16/16 tests de ChunkingService pasan.',
                tags: ['bugfix'],
                docPath: 'sessions/20260126_162831_bugfix_qdrant_chunking.md'
            },
            {
                id: '20260126_090724',
                date: '2026-01-26',
                time: '09:07',
                duration: '2.0h',
                title: 'Fase 5: WebUI Integration y Fase 6: Hangfire',
                summary: 'Completada la integracion WebUI de Fase 5: FileUpload.razor usa MediatR directamente para subir archivos, Detail.razor carga documentos de BD y permite eliminarlos. Avance en Fase 6: Hangfire configurado con dashboard en /hangfire, DocumentProcessingJob con reintentos automaticos, TextExtractionService para archivos de texto. Jobs se encolan automaticamente despues de upload. Total: 160 tests.',
                tags: ['feature', 'setup'],
                docPath: 'sessions/20260126_090724_fase5_webui_fase6_hangfire.md'
            },
            {
                id: '20260125_202951',
                date: '2026-01-25',
                time: '20:29',
                duration: '1.5h',
                title: 'Fase 3: CRUD Completo de Proyectos',
                summary: 'Completada la Fase 3 con CRUD completo de proyectos. Se implementaron SearchProjectsQuery y handler, ProjectsController con 6 endpoints REST (GET, POST, PUT, DELETE, search), DTOs de request, y 30 tests unitarios para todos los handlers. Total: 88 tests. WebUI conectada a datos reales via MediatR.',
                tags: ['feature', 'test'],
                docPath: 'sessions/20260125_202951_fase3_crud_proyectos.md'
            },
            {
                id: '20260125_193629',
                date: '2026-01-25',
                time: '19:36',
                duration: '2.5h',
                title: 'Fase 2: CQRS con MediatR',
                summary: 'Implementacion completa de infraestructura CQRS: patron Result para manejo funcional de errores, interfaces ICommand/IQuery, behaviors de pipeline (Logging, Validation, ExceptionHandling), repositorios con Unit of Work, y 31 tests unitarios. Resueltos problemas de compatibilidad con MediatR 14 y NSubstitute.',
                tags: ['feature', 'test'],
                docPath: 'sessions/20260125_193629_fase2_cqrs_mediatr.md'
            },
            {
                id: '20260125_164840',
                date: '2026-01-25',
                time: '16:48',
                duration: '2.0h',
                title: 'Fase 1: Infraestructura y Base de Datos',
                summary: 'Implementaci√≥n completa de la Fase 1: Docker Compose (SQL Server, Qdrant, Azure OCR), migraciones EF Core con DocumentChunk, clases de configuraci√≥n Options Pattern, QdrantInitializationService, ConfigurationValidator, BabelDbContextFactory. Creaci√≥n de PLAN_DESARROLLO.md con roadmap de 11 fases y QUICKSTART.md. Correcci√≥n de skill end-session para eliminar operaciones git autom√°ticas.',
                tags: ['setup', 'feature', 'documentation'],
                docPath: 'sessions/20260125_164840_fase1_infraestructura.md'
            },
            {
                id: '20260125_151330',
                date: '2026-01-25',
                time: '15:13',
                duration: '0.5h',
                title: 'Health Checks Lazy Load y Correccion de Configuracion',
                summary: 'Se optimizo el componente ServiceStatusIndicator para que los health checks solo se ejecuten bajo demanda (al pulsar el boton), eliminando la carga automatica que causaba retrasos en el arranque. Se corrigio un bug donde WebUI no cargaba appsettings.local.json, causando fallos en la conexion a SQL Server. Se ajusto la posicion del menu de status.',
                tags: ['bugfix', 'refactor'],
                docPath: 'sessions/20260125_151330_healthcheck_lazy_load.md'
            },
            {
                id: '20260125_105026',
                date: '2026-01-25',
                time: '10:50',
                duration: '1.5h',
                title: 'Layout Inicial WebUI con MudBlazor',
                summary: 'Se creo el proyecto Babel.WebUI con Blazor Server y MudBlazor 8.0. Se implemento el layout principal con AppBar, Drawer y tema claro/oscuro. Se crearon componentes: ServiceStatusIndicator (health checks), ProjectCard, FileUpload (drag-and-drop), ChatWindow y ChatMessage (chat RAG). Se anadieron DTOs ProjectDto, DocumentDto y ChatMessageDto. Datos mock con 3 proyectos de ejemplo.',
                tags: ['feature', 'setup'],
                docPath: 'sessions/20260125_105026_layout_webui_mudblazor.md'
            },
            {
                id: '20260125_101719',
                date: '2026-01-25',
                time: '10:17',
                duration: '1.5h',
                title: 'Dise√±o de Entidades de Dominio',
                summary: 'Se dise√±aron e implementaron las entidades de dominio mejoradas para gestionar proyectos y documentos. Se cre√≥ la nueva entidad DocumentChunk para soportar chunking en RAG con Qdrant. Se a√±adieron campos como FileSizeBytes, ContentHash, MimeType, IsVectorized a Document. Se cre√≥ proyecto de tests con 27 tests unitarios usando xUnit y FluentAssertions.',
                tags: ['feature', 'test', 'documentation'],
                docPath: 'sessions/20260125_101719_diseno_entidades_dominio.md'
            },
            {
                id: '20260125_101406',
                date: '2026-01-25',
                time: '10:14',
                duration: '0.5h',
                title: 'Creaci√≥n de Skill Frontend para MudBlazor',
                summary: 'Se cre√≥ un skill especializado de Claude Code para desarrollo frontend con Blazor Server y MudBlazor. El skill incluye gu√≠as de configuraci√≥n, patrones de componentes (ProjectCard, FileList, FileUpload, ChatWindow), convenciones de nombrado, integraci√≥n con MediatR, referencia r√°pida de MudBlazor y troubleshooting com√∫n.',
                tags: ['feature', 'documentation'],
                docPath: 'sessions/20260125_101406_frontend_skill_mudblazor.md'
            },
            {
                id: '20260125_093956',
                date: '2026-01-25',
                time: '09:39',
                duration: '0.5h',
                title: 'Configuraci√≥n de Secrets con appsettings.local.json',
                summary: 'Se implement√≥ un sistema para proteger las claves sensibles del repositorio. Se cre√≥ appsettings.local.json (ignorado por Git) para almacenar secretos, se limpi√≥ appsettings.json de credenciales, y se actualiz√≥ Program.cs para cargar la configuraci√≥n local. Tambi√©n se cre√≥ una plantilla .example para otros desarrolladores.',
                tags: ['setup', 'documentation'],
                docPath: 'sessions/20260125_093956_configuracion_secrets_appsettings.md'
            },
            {
                id: '20260124_112606',
                date: '2026-01-24',
                time: '11:26',
                duration: '3.5h',
                title: 'Creaci√≥n del Proyecto Base y Correcci√≥n de QdrantClient',
                summary: 'Sesi√≥n inicial donde se cre√≥ toda la estructura del proyecto Babel usando Clean Architecture con .NET 10.0. Se implementaron las 4 capas (Domain, Application, Infrastructure, API), se configur√≥ Entity Framework Core, y se crearon health checks para verificar las conexiones a SQL Server, Qdrant y Azure OCR. Tambi√©n se resolvi√≥ un bug cr√≠tico con la inicializaci√≥n de QdrantClient que requer√≠a un objeto Uri en lugar de un string.',
                tags: ['setup', 'bugfix', 'documentation'],
                docPath: 'sessions/20260124_112606_proyecto_base_y_correccion_qdrant.md'
            }
        ];

        // Renderizar men√∫ de navegaci√≥n
        const menu = document.getElementById('session-menu').querySelector('ul');
        sessions.forEach(session => {
            const li = document.createElement('li');
            li.innerHTML = `<a href="#session-${session.id}">${session.date}</a>`;
            menu.appendChild(li);
        });

        // Renderizar sesiones
        const container = document.getElementById('sessions-container');
        sessions.forEach(session => {
            const div = document.createElement('div');
            div.className = 'session';
            div.id = `session-${session.id}`;
            div.innerHTML = `
                <div class="session-header">
                    <h2 class="session-title">${session.title}</h2>
                    <div class="session-meta">
                        üìÖ ${session.date} ${session.time}<br>
                        ‚è±Ô∏è ${session.duration}
                    </div>
                </div>
                <div class="session-tags">
                    ${session.tags.map(tag => `<span class="tag ${tag}">${tag}</span>`).join('')}
                </div>
                <p class="session-summary">${session.summary}</p>
                <a href="${session.docPath}" class="session-link">üìÑ Ver documentaci√≥n completa ‚Üí</a>
            `;
            container.appendChild(div);
        });

        // Actualizar estad√≠sticas
        document.getElementById('total-sessions').textContent = sessions.length;
        const totalHours = sessions.reduce((sum, s) => {
            const hours = parseFloat(s.duration.replace('h', ''));
            return sum + hours;
        }, 0);
        document.getElementById('total-hours').textContent = totalHours.toFixed(1) + 'h';
        document.getElementById('last-session').textContent = sessions[0]?.date || '-';

        // Fecha de √∫ltima actualizaci√≥n
        document.getElementById('last-update').textContent = new Date().toLocaleString('es-ES');
    </script>
</body>
</html>
